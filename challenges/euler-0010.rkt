;;;---------------------------------------------------------------------------------------------------
;;; Project Euler 10: Summation of Primes
;;;---------------------------------------------------------------------------------------------------

#lang racket/base

(provide test solve)

(require data/bit-vector "../lib/primes.rkt")


;;;---------------------------------------------------------------------------------------------------
;;; Solution
;;;---------------------------------------------------------------------------------------------------

(define (euler n)
  (let ([sieve (prime-sieve n)])
    (for/sum ([i (in-range n)]
              #:when (bit-vector-ref sieve i))
      i)))


;;;---------------------------------------------------------------------------------------------------
;;; Runme interface
;;;---------------------------------------------------------------------------------------------------

(define (test) (= 17 (euler 10)))
(define (solve) (euler 2000000))