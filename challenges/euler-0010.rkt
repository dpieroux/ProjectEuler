;;;---------------------------------------------------------------------------------------------------
;;; Project Euler 10: Summation of Primes
;;;---------------------------------------------------------------------------------------------------

#lang racket/base

(provide test solve)

(require "../lib/prime-gen.rkt")


;;;---------------------------------------------------------------------------------------------------
;;; Solution
;;;---------------------------------------------------------------------------------------------------

(define (euler n)
  (let ([gen (make-prime-gen2)])
    (let loop ([s   0]
               [p (gen 'next)])
      (if (< p n)
          (loop (+ s p) (gen 'next))
          s))))


;;;---------------------------------------------------------------------------------------------------
;;; Runme interface
;;;---------------------------------------------------------------------------------------------------

(define (test) (= 17 (euler 10)))
(define (solve) (euler 2000000))